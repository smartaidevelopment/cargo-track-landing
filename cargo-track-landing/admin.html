<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin Dashboard - Aurion">
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“¦</text></svg>">
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“¦</text></svg>">
    <title>Admin Dashboard - Aurion</title>
    <link rel="stylesheet" href="styles.css?v=20260219c">
    <link rel="stylesheet" href="dashboard.css?v=20260219c">
    <link rel="stylesheet" href="admin.css?v=20260219c">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body class="dashboard">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-brand">
                <i class="fas fa-shield-alt"></i>
                <span>Admin Panel</span>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <a href="#admin-dashboard" class="nav-item active" data-section="admin-dashboard">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </a>
            <a href="#admin-users" class="nav-item" data-section="admin-users">
                <i class="fas fa-users"></i>
                <span>User Management</span>
            </a>
            <a href="#admin-packages" class="nav-item" data-section="admin-packages">
                <i class="fas fa-box"></i>
                <span>Package Management</span>
            </a>
            <a href="#admin-payments" class="nav-item" data-section="admin-payments">
                <i class="fas fa-credit-card"></i>
                <span>Payments</span>
            </a>
            <a href="#admin-invoices" class="nav-item" data-section="admin-invoices">
                <i class="fas fa-file-invoice"></i>
                <span>Invoices & Billing</span>
            </a>
            <a href="#admin-analytics" class="nav-item" data-section="admin-analytics">
                <i class="fas fa-chart-line"></i>
                <span>Financial & Analytics</span>
            </a>
            <a href="#admin-devices" class="nav-item" data-section="admin-devices">
                <i class="fas fa-microchip"></i>
                <span>All Devices</span>
            </a>
            <a href="#admin-reseller" class="nav-item" data-section="admin-reseller">
                <i class="fas fa-network-wired"></i>
                <span>Reseller Workspaces</span>
            </a>
            <a href="#admin-security" class="nav-item" data-section="admin-security">
                <i class="fas fa-shield-alt"></i>
                <span>Security & Privacy</span>
            </a>
            <a href="#admin-settings" class="nav-item" data-section="admin-settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </nav>
        
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- Global Toolbar -->
        <div class="dashboard-toolbar executive-toolbar global-toolbar" id="adminGlobalToolbar">
            <div class="dashboard-toolbar-left">
                <div class="dashboard-home-search">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search users, devices..." id="adminSearch">
                </div>
            </div>
            <div class="dashboard-toolbar-right">
                <div class="notifications dashboard-home-notifications">
                    <button class="notification-btn" id="adminNotificationBtn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count" id="adminNotificationCount">0</span>
                    </button>
                </div>
                <div class="account-dropdown-wrap" id="adminAccountDropdownWrap">
                    <button class="dashboard-account-btn" id="adminAccountBtn" type="button" aria-label="Admin account" aria-haspopup="true" aria-expanded="false">
                        <span class="dashboard-account-avatar" id="adminAccountAvatar">A</span>
                        <i class="fas fa-chevron-down" aria-hidden="true"></i>
                    </button>
                    <div class="account-dropdown" id="adminAccountDropdown">
                        <div class="account-dropdown-header">
                            <span class="account-dropdown-avatar" id="adminDropdownAvatar">A</span>
                            <div class="account-dropdown-info">
                                <span class="account-dropdown-name" id="adminDropdownName">Admin</span>
                                <span class="account-dropdown-email" id="adminDropdownEmail"></span>
                            </div>
                        </div>
                        <div class="account-dropdown-divider"></div>
                        <button class="account-dropdown-item" id="adminDropdownSettings" type="button">
                            <i class="fas fa-cog"></i> Settings
                        </button>
                        <div class="account-dropdown-divider"></div>
                        <button class="account-dropdown-item account-dropdown-logout" id="adminLogoutBtn" type="button">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard Section -->
        <section id="admin-dashboard" class="content-section active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="adminTotalUsers">0</h3>
                        <p>Total Users</p>
                        <span class="stat-change" id="adminUsersChange"></span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <i class="fas fa-euro-sign"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="adminTotalRevenue">&euro;0</h3>
                        <p>Total Revenue</p>
                        <span class="stat-change" id="adminRevenueChange"></span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="adminTotalDevices">0</h3>
                        <p>Total Devices</p>
                        <span class="stat-change" id="adminDevicesChange"></span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="adminActiveSubscriptions">0</h3>
                        <p>Active Subscriptions</p>
                        <span class="stat-change" id="adminSubscriptionsChange"></span>
                    </div>
                </div>
            </div>

            <!-- Global Live Map -->
            <div class="dashboard-card full-width" style="margin-top: 1.5rem;">
                <div class="card-header">
                    <h2><i class="fas fa-globe"></i> Global Live Tracking Map - All Devices</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-small" id="refreshAdminGlobalMapBtn" title="Refresh Map">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                        <button class="btn btn-outline btn-small" id="toggleAdminMapAutoRefresh" title="Auto Refresh">
                            <i class="fas fa-play"></i> Auto Refresh
                        </button>
                    </div>
                </div>
                <div id="adminGlobalMap" class="map-container" style="height: 500px; width: 100%; border-radius: 0.5rem; overflow: hidden;"></div>
                <div class="map-legend" style="padding: 1rem; background: #f9fafb; border-top: 1px solid #e5e7eb;">
                    <div style="display: flex; gap: 2rem; flex-wrap: wrap; font-size: 0.875rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <div style="width: 16px; height: 16px; background: #10b981; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                            <span>Active Tracker</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <div style="width: 16px; height: 16px; background: #ef4444; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                            <span>Inactive/Alert</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <div style="width: 16px; height: 16px; background: #f59e0b; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                            <span>Warning</span>
                        </div>
                        <div id="adminMapStats" style="margin-left: auto; color: var(--text-light);">
                            <span id="adminMapDeviceCount">0</span> devices tracked across all users
                        </div>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Recent Users</h2>
                        <button class="btn-icon">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Package</th>
                                    <th>Joined</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recentUsersTable">
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Revenue Overview</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2>System Activity</h2>
                </div>
                <div class="activity-list" id="adminActivityList">
                    <!-- Activity items will be populated by JS -->
                </div>
            </div>
        </section>

        <!-- User Management Section -->
        <section id="admin-users" class="content-section">
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2>User Management</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-small" id="exportUsersBtn">
                            <i class="fas fa-download"></i> Export
                        </button>
                        <button class="btn btn-primary btn-small" id="addUserBtn">
                            <i class="fas fa-user-plus"></i> Add User
                        </button>
                    </div>
                </div>
                
                <div class="admin-filters" style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center; padding: 1rem; background: var(--bg-light); border-radius: 0.5rem; margin-bottom: 1rem;">
                    <div class="filter-group" style="flex: 1; min-width: 150px;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-dark);">Filter by Status:</label>
                        <select id="filterUserStatus" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 0.25rem;">
                            <option value="all">All Users</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="suspended">Suspended</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 1; min-width: 150px;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-dark);">Filter by Package:</label>
                        <select id="filterUserPackage" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 0.25rem;">
                            <option value="all">All Packages</option>
                            <option value="track">Track</option>
                            <option value="monitor">Monitor</option>
                            <option value="predict">Predict</option>
                        </select>
                    </div>
                    <div class="filter-group" style="flex: 2; min-width: 200px;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-dark);">Search:</label>
                        <input type="text" id="userSearchInput" placeholder="Search by email, company..." style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 0.25rem;">
                    </div>
                    <div class="filter-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn-outline btn-small" id="clearFiltersBtn" style="height: 38px;">
                            <i class="fas fa-times"></i> Clear Filters
                        </button>
                    </div>
                </div>
                
                <div id="usersStats" style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
                    <div style="padding: 0.75rem 1rem; background: var(--bg-light); border-radius: 0.5rem; flex: 1; min-width: 150px;">
                        <div style="font-size: 0.875rem; color: var(--text-light); margin-bottom: 0.25rem;">Total Users</div>
                        <div style="font-size: 1.5rem; font-weight: 600; color: var(--primary-color);" id="totalUsersCount">0</div>
                    </div>
                    <div style="padding: 0.75rem 1rem; background: var(--bg-light); border-radius: 0.5rem; flex: 1; min-width: 150px;">
                        <div style="font-size: 0.875rem; color: var(--text-light); margin-bottom: 0.25rem;">Active Users</div>
                        <div style="font-size: 1.5rem; font-weight: 600; color: #10b981;" id="activeUsersCount">0</div>
                    </div>
                    <div style="padding: 0.75rem 1rem; background: var(--bg-light); border-radius: 0.5rem; flex: 1; min-width: 150px;">
                        <div style="font-size: 0.875rem; color: var(--text-light); margin-bottom: 0.25rem;">Filtered Results</div>
                        <div style="font-size: 1.5rem; font-weight: 600; color: var(--text-dark);" id="filteredUsersCount">0</div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Company</th>
                                <th>Package</th>
                                <th>Devices</th>
                                <th>Status</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersManagementTable">
                            <!-- Table rows will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- User Details Modal -->
            <div id="userDetailsModal" class="modal">
                <div class="modal-content modal-large">
                    <div class="modal-header">
                        <h2 id="userDetailsTitle">User Details</h2>
                        <button class="modal-close" id="closeUserModal">&times;</button>
                    </div>
                    <div class="modal-body" id="userDetailsBody">
                        <!-- User details will be populated by JS -->
                    </div>
                </div>
            </div>
            
            <!-- Add/Edit User Modal -->
            <div id="addUserModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="addUserModalTitle"><i class="fas fa-user-plus"></i> Add New User</h2>
                        <button class="modal-close" id="closeAddUserModal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="addUserForm" class="settings-form">
                            <div class="form-group">
                                <label for="newUserEmail">Email Address *</label>
                                <input type="email" id="newUserEmail" name="email" required autocomplete="email" placeholder="user@example.com">
                                <small>This will be the user's login email</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserPassword">Password *</label>
                                <input type="password" id="newUserPassword" name="password" required minlength="6" autocomplete="new-password" placeholder="Minimum 6 characters">
                                <small>Minimum 6 characters</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserCompany">Company Name</label>
                                <input type="text" id="newUserCompany" name="company" autocomplete="organization" placeholder="Company Name">
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserPhone">Phone Number</label>
                                <input type="tel" id="newUserPhone" name="phone" autocomplete="tel" placeholder="+1 (555) 123-4567">
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserPackage">Package *</label>
                                <select id="newUserPackage" name="package" required>
                                    <option value="track">Track (&euro;9.95/asset/mo)</option>
                                    <option value="monitor" selected>Monitor (&euro;14.95/asset/mo)</option>
                                    <option value="predict">Predict (&euro;24.95/asset/mo)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="newUserDevices">Number of Assets</label>
                                <input type="number" id="newUserDevices" name="devices" min="1" value="1" required>
                                <small>Number of tracked assets (free hardware with 24-month plan)</small>
                            </div>
                            
                            <div class="form-group checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="newUserActive" name="isActive" checked>
                                    <span>Account Active</span>
                                </label>
                                <small>Uncheck to create an inactive account</small>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="sendWelcomeEmail" checked>
                                    <span>Send welcome email with login credentials</span>
                                </label>
                            </div>
                            
                            <div class="modal-footer" style="margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-outline" id="cancelAddUserBtn">Cancel</button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-user-plus"></i> Create User
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Edit User Modal -->
            <div id="editUserModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2><i class="fas fa-user-edit"></i> Edit User</h2>
                        <button class="modal-close" id="closeEditUserModal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="editUserForm" class="settings-form">
                            <input type="hidden" id="editUserId" name="userId">
                            
                            <div class="form-group">
                                <label for="editUserEmail">Email Address *</label>
                                <input type="email" id="editUserEmail" name="email" required autocomplete="email">
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserCompany">Company Name</label>
                                <input type="text" id="editUserCompany" name="company" autocomplete="organization">
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserPhone">Phone Number</label>
                                <input type="tel" id="editUserPhone" name="phone" autocomplete="tel">
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserPackage">Package *</label>
                                <select id="editUserPackage" name="package" required>
                                    <option value="track">Track (&euro;9.95/asset/mo)</option>
                                    <option value="monitor">Monitor (&euro;14.95/asset/mo)</option>
                                    <option value="predict">Predict (&euro;24.95/asset/mo)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserDevices">Number of Devices</label>
                                <input type="number" id="editUserDevices" name="devices" min="1" value="1" required>
                            </div>
                            
                            <div class="form-group checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="editUserActive" name="isActive">
                                    <span>Account Active</span>
                                </label>
                            </div>
                            
                            <div class="form-group">
                                <label for="editUserPassword">Change Password (Optional)</label>
                                <input type="password" id="editUserPassword" name="password" minlength="6" autocomplete="new-password" placeholder="Leave empty to keep current password">
                                <small>Enter new password to change it</small>
                            </div>
                            
                            <div class="modal-footer" style="margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-outline" id="cancelEditUserBtn">Cancel</button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Save Changes
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Package Management Section -->
        <section id="admin-packages" class="content-section">
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2><i class="fas fa-box"></i> Package Management</h2>
                    <div class="card-actions">
                        <button class="btn btn-primary btn-small" id="addPackageBtn">
                            <i class="fas fa-plus"></i> Add Package
                        </button>
                    </div>
                </div>
                
                <p style="margin-bottom:1rem;color:var(--text-light);">Pricing per asset per month. Free hardware with every 24-month plan. Packages match the landing page tiers.</p>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Package</th>
                                <th>Price / Asset</th>
                                <th>Tracking &amp; Data</th>
                                <th>Max Assets</th>
                                <th>Status</th>
                                <th>Features</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="packagesTable">
                            <!-- Packages will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Payments Section -->
        <section id="admin-payments" class="content-section">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Payment Methods</h2>
                    </div>
                    <div class="payment-methods-config">
                        <div class="payment-method-item">
                            <div class="payment-method-header">
                                <i class="fab fa-stripe"></i>
                                <h3>Stripe</h3>
                                <span class="status-badge active" id="stripeStatus">Connected</span>
                            </div>
                            <div class="payment-method-body">
                                <div class="form-group">
                                    <label>Publishable Key</label>
                                    <input type="text" id="stripePublishableKey" placeholder="pk_live_..." readonly>
                                    <small>Configured</small>
                                </div>
                                <div class="form-group">
                                    <label>Secret Key</label>
                                    <input type="password" id="stripeSecretKey" placeholder="sk_live_..." readonly>
                                    <small>Hidden for security</small>
                                </div>
                                <button class="btn btn-outline btn-small" onclick="configurePaymentMethod('stripe')">
                                    <i class="fas fa-edit"></i> Configure
                                </button>
                            </div>
                        </div>
                        
                        <div class="payment-method-item">
                            <div class="payment-method-header">
                                <i class="fab fa-paypal"></i>
                                <h3>PayPal</h3>
                                <span class="status-badge active" id="paypalStatus">Standard Mode (Ready)</span>
                            </div>
                            <div class="payment-method-body">
                                <div style="background: #e3f2fd; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; border-left: 4px solid #2196f3;">
                                    <h4 style="margin: 0 0 0.5rem 0; color: #1976d2; font-size: 0.875rem;">
                                        <i class="fas fa-info-circle"></i> Easy Setup - No Developer Account Needed!
                                    </h4>
                                    <p style="margin: 0; font-size: 0.875rem; color: #424242; line-height: 1.5;">
                                        Use PayPal Smart Buttons - only requires a Client ID from your PayPal Business account. 
                                        No secret keys or developer registration needed!
                                    </p>
                                </div>
                                
                                <div class="form-group">
                                    <label>PayPal Client ID (Optional - for Smart Buttons)</label>
                                    <input type="text" id="paypalClientId" placeholder="Enter PayPal Client ID (optional)">
                                    <small>
                                        <strong>Easy Setup:</strong> Get this from your PayPal Business account â†’ Account Settings â†’ Website Preferences â†’ PayPal Buttons<br>
                                        <strong>Or leave empty</strong> to use PayPal Standard (no setup required, redirects to PayPal)
                                    </small>
                                </div>
                                
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="paypalUseSmartButtons" checked>
                                        Use PayPal Smart Buttons (Recommended - better UX)
                                    </label>
                                    <small>If unchecked, uses PayPal Standard redirect (no Client ID needed)</small>
                                </div>
                                
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="paypalSandboxMode">
                                        Enable Sandbox Mode (for testing)
                                    </label>
                                    <small>Use PayPal sandbox for testing payments</small>
                                </div>
                                
                                <div style="background: #f5f5f5; padding: 1rem; border-radius: 0.5rem; margin-top: 1rem;">
                                    <h4 style="margin: 0 0 0.75rem 0; font-size: 0.875rem; color: var(--text-dark);">
                                        <i class="fas fa-lightbulb"></i> Quick Setup Guide:
                                    </h4>
                                    <ol style="margin: 0; padding-left: 1.25rem; font-size: 0.875rem; color: var(--text-light); line-height: 1.8;">
                                        <li><strong>Option 1 (Easiest):</strong> Leave Client ID empty - PayPal Standard will work automatically</li>
                                        <li><strong>Option 2 (Better UX):</strong> Log into your PayPal Business account â†’ Account Settings â†’ Website Preferences â†’ Copy your Client ID</li>
                                        <li><strong>No Developer Account:</strong> You don't need to register as a developer - just use your regular PayPal Business account</li>
                                        <li><strong>No Secret Keys:</strong> PayPal Smart Buttons don't require secret keys</li>
                                    </ol>
                                </div>
                                
                                <button class="btn btn-primary btn-small" onclick="savePayPalSettings()" style="margin-top: 1rem;">
                                    <i class="fas fa-save"></i> Save PayPal Settings
                                </button>
                            </div>
                        </div>
                        
                        <div class="payment-method-item">
                            <div class="payment-method-header">
                                <i class="fas fa-university"></i>
                                <h3>Bank Transfer</h3>
                                <span class="status-badge active">Enabled</span>
                            </div>
                            <div class="payment-method-body">
                                <div class="form-group">
                                    <label>Bank Account Details</label>
                                    <textarea id="bankDetails" rows="4" placeholder="Enter bank account information for manual processing"></textarea>
                                </div>
                                <button class="btn btn-outline btn-small" onclick="saveBankDetails()">
                                    <i class="fas fa-save"></i> Save
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Payment Statistics</h2>
                    </div>
                    <div class="payment-stats">
                        <div class="stat-item">
                            <span class="stat-label">Total Revenue</span>
                            <span class="stat-value" id="totalRevenue">&euro;0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">This Month</span>
                            <span class="stat-value" id="monthlyRevenue">&euro;0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Pending</span>
                            <span class="stat-value" id="pendingRevenue">&euro;0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Failed</span>
                            <span class="stat-value" id="failedPayments">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2>Payment Transactions</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-small" id="exportPaymentsBtn">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Transaction ID</th>
                                <th>User</th>
                                <th>Package</th>
                                <th>Amount</th>
                                <th>Method</th>
                                <th>Status</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="paymentsTable">
                            <!-- Table rows will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Invoices & Billing Section -->
        <section id="admin-invoices" class="content-section">
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2><i class="fas fa-file-invoice"></i> Invoice Management</h2>
                    <div class="card-actions">
                        <button class="btn btn-primary btn-small" id="createInvoiceBtn">
                            <i class="fas fa-plus"></i> Create Invoice
                        </button>
                        <button class="btn btn-outline btn-small" onclick="generateAllInvoices()">
                            <i class="fas fa-sync-alt"></i> Generate Missing
                        </button>
                        <button class="btn btn-outline btn-small" id="exportInvoicesBtn">
                            <i class="fas fa-download"></i> Export All
                        </button>
                    </div>
                </div>
                
                <div class="admin-filters">
                    <div class="filter-group">
                        <label>Filter by Status:</label>
                        <select id="filterInvoiceStatus">
                            <option value="all">All Invoices</option>
                            <option value="paid">Paid</option>
                            <option value="pending">Pending</option>
                            <option value="overdue">Overdue</option>
                            <option value="void">Void</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Date Range:</label>
                        <select id="filterInvoiceDateRange">
                            <option value="all">All Time</option>
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <input type="text" id="invoiceSearchInput" placeholder="Search invoices...">
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAllInvoices" title="Select all"></th>
                                <th>Invoice #</th>
                                <th>Customer</th>
                                <th>Date</th>
                                <th>Due Date</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Payment Method</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminInvoicesTable">
                        </tbody>
                    </table>
                </div>

                <div class="invoice-bulk-actions" id="invoiceBulkActions" style="display:none;">
                    <span id="invoiceSelectedCount">0 selected</span>
                    <button class="btn btn-small btn-outline" onclick="bulkMarkInvoicesPaid()">
                        <i class="fas fa-check-circle"></i> Mark Paid
                    </button>
                    <button class="btn btn-small btn-outline" onclick="bulkSendInvoices()">
                        <i class="fas fa-paper-plane"></i> Send
                    </button>
                    <button class="btn btn-small btn-outline btn-danger-outline" onclick="bulkDeleteInvoices()">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Invoice Statistics</h2>
                    </div>
                    <div class="invoice-stats">
                        <div class="stat-item">
                            <span class="stat-label">Total Invoices</span>
                            <span class="stat-value" id="adminTotalInvoices">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Revenue</span>
                            <span class="stat-value" id="adminInvoiceRevenue">&euro;0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Paid Invoices</span>
                            <span class="stat-value" id="adminPaidInvoices">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Pending</span>
                            <span class="stat-value" id="adminPendingInvoices">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Overdue</span>
                            <span class="stat-value" id="adminOverdueInvoices">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Recent Invoices</h2>
                    </div>
                    <div class="recent-invoices-list" id="recentInvoicesList">
                    </div>
                </div>
            </div>
        </section>

        <!-- Financial & Analytics Section -->
        <section id="admin-analytics" class="content-section">
            <!-- Financial Overview -->
            <div class="stats-grid">
                <div class="stat-card financial">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-euro-sign"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalRevenueAnalytics">&euro;0</h3>
                        <p>Total Revenue</p>
                        <span class="stat-change" id="revenueChange"></span>
                    </div>
                </div>
                
                <div class="stat-card financial">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="monthlyRecurringRevenue">&euro;0</h3>
                        <p>Monthly Recurring Revenue (MRR)</p>
                        <span class="stat-change" id="mrrChange"></span>
                    </div>
                </div>
                
                <div class="stat-card financial">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="averageRevenuePerUser">&euro;0</h3>
                        <p>Average Revenue Per User (ARPU)</p>
                        <span class="stat-change" id="arpuChange"></span>
                    </div>
                </div>
                
                <div class="stat-card financial">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="churnRate">0%</h3>
                        <p>Churn Rate</p>
                        <span class="stat-change" id="churnChange"></span>
                    </div>
                </div>
            </div>

            <!-- Financial Charts -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Revenue Trend</h2>
                        <div class="card-actions">
                            <select id="revenuePeriod" class="period-selector">
                                <option value="7">Last 7 Days</option>
                                <option value="30" selected>Last 30 Days</option>
                                <option value="90">Last 90 Days</option>
                                <option value="365">Last Year</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueTrendChart"></canvas>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Revenue by Package</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueByPackageChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Business Metrics -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>User Growth</h2>
                        <div class="card-actions">
                            <select id="growthPeriod" class="period-selector">
                                <option value="7">Last 7 Days</option>
                                <option value="30" selected>Last 30 Days</option>
                                <option value="90">Last 90 Days</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="userGrowthChart"></canvas>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Subscription Distribution</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="subscriptionDistributionChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Detailed Financial Analysis -->
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2>Financial Breakdown</h2>
                    <div class="card-actions">
                        <button class="btn btn-outline btn-small" id="exportFinancialReportBtn">
                            <i class="fas fa-download"></i> Export Report
                        </button>
                    </div>
                </div>
                <div class="financial-breakdown">
                    <div class="breakdown-grid">
                        <div class="breakdown-section">
                            <h3><i class="fas fa-money-bill-wave"></i> Revenue Analysis</h3>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Total Revenue (All Time)</span>
                                <span class="breakdown-value" id="breakdownTotalRevenue">&euro;0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">This Month</span>
                                <span class="breakdown-value" id="breakdownMonthlyRevenue">&euro;0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Last Month</span>
                                <span class="breakdown-value" id="breakdownLastMonthRevenue">&euro;0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">This Year</span>
                                <span class="breakdown-value" id="breakdownYearlyRevenue">&euro;0</span>
                            </div>
                            <div class="breakdown-item highlight">
                                <span class="breakdown-label">Growth Rate (MoM)</span>
                                <span class="breakdown-value positive" id="breakdownGrowthRate">0%</span>
                            </div>
                        </div>
                        
                        <div class="breakdown-section">
                            <h3><i class="fas fa-users"></i> Customer Metrics</h3>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Total Customers</span>
                                <span class="breakdown-value" id="breakdownTotalCustomers">0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">New This Month</span>
                                <span class="breakdown-value" id="breakdownNewCustomers">0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Active Subscriptions</span>
                                <span class="breakdown-value" id="breakdownActiveSubscriptions">0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Churned This Month</span>
                                <span class="breakdown-value negative" id="breakdownChurned">0</span>
                            </div>
                            <div class="breakdown-item highlight">
                                <span class="breakdown-label">Customer Lifetime Value (CLV)</span>
                                <span class="breakdown-value" id="breakdownCLV">&euro;0</span>
                            </div>
                        </div>
                        
                        <div class="breakdown-section">
                            <h3><i class="fas fa-box"></i> Package Performance</h3>
                            <div class="breakdown-item">
                                <span class="breakdown-label"><span style="display:inline-block;width:8px;height:8px;background:#3b82f6;border-radius:50%;margin-right:0.4rem;"></span>Track Revenue</span>
                                <span class="breakdown-value" id="breakdownTrackRevenue">&euro;0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label"><span style="display:inline-block;width:8px;height:8px;background:#10b981;border-radius:50%;margin-right:0.4rem;"></span>Monitor Revenue</span>
                                <span class="breakdown-value" id="breakdownMonitorRevenue">&euro;0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label"><span style="display:inline-block;width:8px;height:8px;background:#f59e0b;border-radius:50%;margin-right:0.4rem;"></span>Predict Revenue</span>
                                <span class="breakdown-value" id="breakdownPredictRevenue">&euro;0</span>
                            </div>
                            <div class="breakdown-item">
                                <span class="breakdown-label">Most Popular Package</span>
                                <span class="breakdown-value" id="breakdownPopularPackage">-</span>
                            </div>
                            <div class="breakdown-item highlight">
                                <span class="breakdown-label">Average Package Value</span>
                                <span class="breakdown-value" id="breakdownAvgPackageValue">&euro;0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Payment Method Analysis -->
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2>Payment Method Analysis</h2>
                </div>
                <div class="chart-container">
                    <canvas id="paymentMethodChart"></canvas>
                </div>
            </div>

            <!-- Forecast & Projections -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Revenue Forecast</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueForecastChart"></canvas>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Key Performance Indicators</h2>
                    </div>
                    <div class="kpi-grid">
                        <div class="kpi-item">
                            <div class="kpi-label">Conversion Rate</div>
                            <div class="kpi-value" id="kpiConversionRate">0%</div>
                            <div class="kpi-subtext">Paying / Total users</div>
                        </div>
                        <div class="kpi-item">
                            <div class="kpi-label">Retention Rate</div>
                            <div class="kpi-value" id="kpiRetentionRate">0%</div>
                            <div class="kpi-subtext">Active / Total users</div>
                        </div>
                        <div class="kpi-item">
                            <div class="kpi-label">LTV/CAC Ratio</div>
                            <div class="kpi-value" id="kpiLTVRatio">0:1</div>
                            <div class="kpi-subtext">Est. lifetime value / acq. cost</div>
                        </div>
                        <div class="kpi-item">
                            <div class="kpi-label">Monthly Growth</div>
                            <div class="kpi-value" id="kpiMonthlyGrowth">0%</div>
                            <div class="kpi-subtext">Revenue MoM change</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- All Devices Section -->
        <section id="admin-devices" class="content-section">
            <!-- Status summary cards -->
            <div class="stats-grid" style="margin-bottom:1.5rem;">
                <div class="stat-card">
                    <i class="fas fa-microchip"></i>
                    <h3 id="adminDevTotal">0</h3>
                    <p>Total Devices</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle" style="color:#10b981;"></i>
                    <h3 id="adminDevOnline" style="color:#10b981;">0</h3>
                    <p>Online</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-exclamation-triangle" style="color:#f59e0b;"></i>
                    <h3 id="adminDevStale" style="color:#f59e0b;">0</h3>
                    <p>Stale / No GPS</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-times-circle" style="color:#ef4444;"></i>
                    <h3 id="adminDevOffline" style="color:#ef4444;">0</h3>
                    <p>Offline</p>
                </div>
            </div>

            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2>All Devices (System-wide)</h2>
                    <div class="card-actions" style="display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap;">
                        <input type="text" id="adminDeviceSearch" placeholder="Search devices..." style="padding:0.4rem 0.75rem;border:1px solid var(--border-color);border-radius:0.375rem;font-size:0.875rem;width:200px;">
                        <select id="adminDeviceFilter" style="padding:0.4rem 0.75rem;border:1px solid var(--border-color);border-radius:0.375rem;font-size:0.875rem;">
                            <option value="all">All Statuses</option>
                            <option value="online">Online</option>
                            <option value="stale">Stale / No GPS</option>
                            <option value="offline">Offline</option>
                        </select>
                        <button class="btn btn-outline btn-small" id="refreshDeviceListBtn" title="Refresh Devices">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                        <button class="btn btn-primary btn-small" id="adminAddDeviceBtn" type="button">
                            <i class="fas fa-plus"></i> Add Device
                        </button>
                        <button class="btn btn-outline btn-small" id="exportDevicesBtn">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Device ID</th>
                                <th>Name</th>
                                <th>Owner / Tenant</th>
                                <th>Type</th>
                                <th>Connection</th>
                                <th>Location</th>
                                <th>Sensors</th>
                                <th>Last Seen</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="allDevicesTable">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Admin Device Modal (View / Edit / Add) -->
            <div id="adminDeviceModal" class="modal">
                <div class="modal-content modal-large">
                    <div class="modal-header">
                        <h2 id="adminDeviceModalTitle">Device Details</h2>
                        <button class="modal-close" id="closeAdminDeviceModal">&times;</button>
                    </div>
                    <div class="modal-body" id="adminDeviceModalBody">
                    </div>
                </div>
            </div>
        </section>

        <section id="admin-reseller" class="content-section">
            <div id="tenantEditModal" class="modal">
                <div class="modal-content" style="max-width:600px;">
                    <div class="modal-header">
                        <h2 id="tenantEditModalTitle"><i class="fas fa-building"></i> Edit Tenant</h2>
                        <button class="modal-close" id="closeTenantEditModal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="tenantEditForm" class="settings-form" onsubmit="return false;">
                            <input type="hidden" id="tenantEditId">
                            <div class="form-group">
                                <label for="tenantEditName">Tenant Name *</label>
                                <input type="text" id="tenantEditName" required placeholder="Company name">
                            </div>
                            <div class="form-group">
                                <label for="tenantEditPlan">Plan Tier</label>
                                <select id="tenantEditPlan">
                                    <option value="individual">Individual</option>
                                    <option value="track">Track</option>
                                    <option value="monitor">Monitor</option>
                                    <option value="predict">Predict</option>
                                </select>
                            </div>

                            <h4 style="margin-top:1.25rem;margin-bottom:0.75rem;"><i class="fas fa-network-wired"></i> Network Settings</h4>
                            <p style="font-size:0.85rem;color:var(--text-light);margin-bottom:0.75rem;">Default network configuration for all devices in this tenant.</p>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tenantEditCarrier">Default Carrier</label>
                                    <input type="text" id="tenantEditCarrier" placeholder="e.g. Vodafone, AT&T">
                                </div>
                                <div class="form-group">
                                    <label for="tenantEditApn">Default APN</label>
                                    <input type="text" id="tenantEditApn" placeholder="e.g. iot.vodafone.com">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tenantEditSimProvider">SIM Provider</label>
                                    <input type="text" id="tenantEditSimProvider" placeholder="e.g. 1NCE, Hologram">
                                </div>
                                <div class="form-group">
                                    <label for="tenantEditNetworkNotes">Network Notes</label>
                                    <input type="text" id="tenantEditNetworkNotes" placeholder="Additional notes">
                                </div>
                            </div>

                            <div class="form-actions" style="margin-top:1.25rem;">
                                <button type="button" class="btn btn-outline" onclick="closeTenantEditModal()">Cancel</button>
                                <button type="button" class="btn btn-primary" onclick="saveTenantEdit()"><i class="fas fa-save"></i> Save Tenant</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Create Tenant Workspace</h2>
                    </div>
                    <form id="createTenantForm" class="settings-form">
                        <div class="form-group">
                            <label>Workspace Name</label>
                            <input type="text" id="tenantName" required>
                        </div>
                        <div class="form-group">
                            <label>Plan Tier</label>
                            <select id="tenantPlanTier">
                                <option value="individual">Individual</option>
                                <option value="smb">SMB</option>
                                <option value="enterprise">Enterprise</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Create Workspace</button>
                    </form>
                </div>
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Tenant Workspaces</h2>
                    </div>
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Plan</th>
                                    <th>Network</th>
                                    <th>Reseller</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="resellerTenantsTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2>Create Tenant User</h2>
                </div>
                <form id="createTenantUserForm" class="settings-form">
                    <div class="form-group">
                        <label>Tenant Workspace</label>
                        <select id="tenantUserWorkspace" required></select>
                    </div>
                    <div class="form-group">
                        <label>User Email</label>
                        <input type="email" id="tenantUserEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Temporary Password</label>
                        <input type="text" id="tenantUserPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Create User</button>
                </form>
                <div class="table-responsive" style="margin-top: 1.5rem;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Email</th>
                                <th>Workspace</th>
                                <th>Plan</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="resellerUsersTable"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Security & Privacy Section -->
        <section id="admin-security" class="content-section">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2><i class="fas fa-shield-alt"></i> Security Settings</h2>
                    </div>
                    <form class="settings-form" id="securitySettingsForm">
                        <div class="form-group">
                            <label>Password Policy</label>
                            <select id="passwordPolicy">
                                <option value="standard">Standard (6+ characters)</option>
                                <option value="strong">Strong (8+ characters, mixed case, numbers)</option>
                                <option value="very-strong">Very Strong (12+ characters, special chars)</option>
                            </select>
                        </div>
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="require2FA" checked>
                                <span>Require 2FA for Admin</span>
                            </label>
                        </div>
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="sessionTimeout">
                                <span>Enable Session Timeout (30 min)</span>
                            </label>
                        </div>
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="ipWhitelist">
                                <span>Enable IP Whitelist</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label>Encryption Level</label>
                            <select id="encryptionLevel">
                                <option value="standard">Standard (TLS 1.2)</option>
                                <option value="high" selected>High (TLS 1.3)</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Security Settings</button>
                    </form>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2><i class="fas fa-user-shield"></i> Data Privacy</h2>
                    </div>
                    <form class="settings-form" id="privacySettingsForm">
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="gdprCompliance" checked>
                                <span>GDPR Compliance Enabled</span>
                            </label>
                        </div>
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="dataEncryption" checked>
                                <span>Encrypt User Data at Rest</span>
                            </label>
                        </div>
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="dataRetention">
                                <span>Auto-delete Data After 90 Days (Inactive Users)</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label>Data Retention Period</label>
                            <select id="dataRetentionPeriod">
                                <option value="30">30 days</option>
                                <option value="90" selected>90 days</option>
                                <option value="365">1 year</option>
                                <option value="unlimited">Unlimited</option>
                            </select>
                        </div>
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="userDataExport">
                                <span>Allow Users to Export Their Data</span>
                            </label>
                        </div>
                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="userDataDeletion">
                                <span>Allow Users to Delete Their Data</span>
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Privacy Settings</button>
                    </form>
                </div>
            </div>
            
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2><i class="fas fa-list"></i> Privacy Requests</h2>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Request ID</th>
                                <th>User</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Requested</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="privacyRequestsTable">
                            <!-- Table rows will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="dashboard-card full-width">
                <div class="card-header">
                    <h2><i class="fas fa-file-alt"></i> Security Audit Log</h2>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Event</th>
                                <th>User</th>
                                <th>IP Address</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="securityAuditLog">
                            <!-- Table rows will be populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Admin Settings Section -->
        <section id="admin-settings" class="content-section">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Application Settings</h2>
                    </div>
                    <form class="settings-form" id="appSettingsForm">
                        <div class="form-group">
                            <label>Application Name</label>
                            <input type="text" id="appName" value="Aurion">
                        </div>
                        <div class="form-group">
                            <label>Support Email</label>
                            <input type="email" id="supportEmail" value="info@aurion.io">
                        </div>
                        <div class="form-group">
                            <label>Support Phone</label>
                            <input type="tel" id="supportPhone" placeholder="Enter support phone number">
                        </div>
                        <div class="form-group">
                            <label>Maintenance Mode</label>
                            <select id="maintenanceMode">
                                <option value="off">Off</option>
                                <option value="on">On</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Settings</button>
                    </form>
                </div>
                
                <div class="dashboard-card">
                    <div class="card-header">
                        <h2>Admin Account</h2>
                    </div>
                    <form class="settings-form" id="adminAccountForm">
                        <div class="form-group">
                            <label>Admin Email</label>
                            <input type="email" id="adminAccountEmail" value="" readonly>
                        </div>
                        <div class="form-group">
                            <label>Change Password</label>
                            <input type="password" id="adminNewPassword" placeholder="Enter new password">
                        </div>
                        <div class="form-group">
                            <label>Confirm Password</label>
                            <input type="password" id="adminConfirmPassword" placeholder="Confirm new password">
                        </div>
                        <button type="submit" class="btn btn-primary">Update Account</button>
                    </form>
                </div>
                
                <!-- LTE Tracker Configuration -->
                <div class="dashboard-card full-width">
                    <div class="card-header">
                        <h2><i class="fas fa-signal"></i> LTE Tracker Configuration</h2>
                    </div>
                    <form class="settings-form" id="lteSettingsForm">
                        <div style="background:rgba(59,130,246,0.08);border:1px solid rgba(59,130,246,0.2);border-radius:0.5rem;padding:0.85rem 1rem;margin-bottom:1.25rem;font-size:0.9rem;color:var(--text-color);">
                            <i class="fas fa-info-circle" style="color:var(--primary);margin-right:0.35rem;"></i>
                            <strong>Per-customer network settings</strong> (Carrier, APN, SIM Provider) are configured in <strong>Tenant Workspaces</strong>. The fields below serve as system-wide fallback defaults.
                        </div>
                        <div class="form-group">
                            <label for="lteDefaultCarrier">Fallback Carrier</label>
                            <input type="text" id="lteDefaultCarrier" name="lteDefaultCarrier" placeholder="Carrier name (e.g., AT&T, Vodafone)" autocomplete="off">
                            <small>System-wide fallback carrier, used when a tenant has no carrier configured.</small>
                        </div>
                        <div class="form-group">
                            <label for="lteDefaultApn">Fallback APN</label>
                            <input type="text" id="lteDefaultApn" name="lteDefaultApn" placeholder="APN (e.g., internet, iot)" autocomplete="off">
                            <small>System-wide fallback APN, used when a tenant has no APN configured.</small>
                        </div>
                        <div class="form-group">
                            <label for="lteIngestEndpoint">Data Ingest Endpoint</label>
                            <input type="url" id="lteIngestEndpoint" name="lteIngestEndpoint" placeholder="https://api.yourdomain.com/lte/ingest" autocomplete="off">
                            <small>Backend endpoint for LTE tracker data ingestion.</small>
                        </div>
                        <div class="form-group">
                            <label for="lteProviderApiKey">Provider API Key</label>
                            <input type="password" id="lteProviderApiKey" name="lteProviderApiKey" placeholder="Provider API key" autocomplete="off">
                            <small>Store a provider API key if your LTE carrier requires it.</small>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="allowUserApiKeys" checked>
                                Allow users to generate their own API keys for integrations
                            </label>
                            <small>When enabled, users can generate API keys to connect their ERPs or external systems</small>
                        </div>
                        <div id="lteValidationStatus" style="display: none; margin-bottom: 1rem; padding: 0.75rem; border-radius: 0.5rem;"></div>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <button type="button" id="testLteConnection" class="btn btn-outline">
                                <i class="fas fa-plug"></i> Test Connection
                            </button>
                            <button type="submit" class="btn btn-primary">Save LTE Settings</button>
                        </div>
                    </form>
                </div>

                <!-- LoRaWAN / ThingPark Configuration -->
                <div class="dashboard-card full-width">
                    <div class="card-header">
                        <h2><i class="fas fa-broadcast-tower"></i> LoRaWAN / ThingPark Configuration</h2>
                    </div>
                    <p style="color:var(--text-light);margin-bottom:1rem;">Configure your LoRaWAN network server connection for pre-provisioning devices. Devices you ship will connect automatically.</p>
                    <form class="settings-form" id="lorawanSettingsForm">
                        <div class="form-row" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
                            <div class="form-group">
                                <label for="lorawanProvider">Network Server Provider</label>
                                <select id="lorawanProvider">
                                    <option value="">Select provider...</option>
                                    <option value="actility">Actility ThingPark</option>
                                    <option value="ttn">The Things Network (TTN)</option>
                                    <option value="chirpstack">ChirpStack</option>
                                    <option value="loriot">LORIOT</option>
                                    <option value="custom">Custom / Other</option>
                                </select>
                                <small>Your LoRaWAN network server provider.</small>
                            </div>
                            <div class="form-group">
                                <label for="lorawanServerUrl">Network Server URL</label>
                                <input type="url" id="lorawanServerUrl" placeholder="https://community.thingpark.io" autocomplete="off">
                                <small>The management/API URL of your network server.</small>
                            </div>
                        </div>
                        <div class="form-row" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
                            <div class="form-group">
                                <label for="lorawanApiKey">API Key / Token</label>
                                <input type="password" id="lorawanApiKey" placeholder="Network server API key" autocomplete="off">
                                <small>Used for device provisioning via the NS API.</small>
                            </div>
                            <div class="form-group">
                                <label for="lorawanAppEui">Default Application ID / App EUI</label>
                                <input type="text" id="lorawanAppEui" placeholder="e.g. 70B3D57ED0040000" autocomplete="off">
                                <small>Application identifier for grouping devices.</small>
                            </div>
                        </div>
                        <div class="form-row" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
                            <div class="form-group">
                                <label for="lorawanJoinEui">Default Join Server / Join EUI</label>
                                <input type="text" id="lorawanJoinEui" placeholder="e.g. 0000000000000000" autocomplete="off">
                                <small>Join EUI for OTAA device activation.</small>
                            </div>
                            <div class="form-group">
                                <label for="lorawanDeviceProfile">Default Device Profile</label>
                                <select id="lorawanDeviceProfile">
                                    <option value="classA">Class A (battery-optimized)</option>
                                    <option value="classB">Class B (scheduled receive)</option>
                                    <option value="classC">Class C (always listening)</option>
                                </select>
                                <small>LoRaWAN device class for new devices.</small>
                            </div>
                        </div>
                        <div class="form-row" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
                            <div class="form-group">
                                <label for="lorawanFreqPlan">Region / Frequency Plan</label>
                                <select id="lorawanFreqPlan">
                                    <option value="EU868">EU868 (Europe)</option>
                                    <option value="US915">US915 (Americas)</option>
                                    <option value="AS923">AS923 (Asia)</option>
                                    <option value="AU915">AU915 (Australia)</option>
                                    <option value="IN865">IN865 (India)</option>
                                    <option value="KR920">KR920 (Korea)</option>
                                    <option value="RU864">RU864 (Russia)</option>
                                </select>
                                <small>Frequency plan for your operating region.</small>
                            </div>
                            <div class="form-group">
                                <label for="lorawanWebhookUrl">Webhook Endpoint</label>
                                <input type="url" id="lorawanWebhookUrl" placeholder="Auto-detected" autocomplete="off" readonly>
                                <small>Auto-filled. This is the URL you set in your NS to forward data to Aurion.</small>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="lorawanWebhookToken">Webhook Auth Token</label>
                            <input type="text" id="lorawanWebhookToken" placeholder="Use your LTE_INGEST_TOKEN value" autocomplete="off" readonly>
                            <small>Use the same <code>LTE_INGEST_TOKEN</code> from your Vercel environment variables. Set as <code>Authorization: Bearer &lt;token&gt;</code> in your NS webhook headers.</small>
                        </div>
                        <div id="lorawanValidationStatus" style="display:none;margin-bottom:1rem;padding:0.75rem;border-radius:0.5rem;"></div>
                        <div style="display:flex;gap:1rem;align-items:center;">
                            <button type="button" id="testLorawanConnection" class="btn btn-outline">
                                <i class="fas fa-plug"></i> Test Connection
                            </button>
                            <button type="submit" class="btn btn-primary">Save LoRaWAN Settings</button>
                        </div>
                    </form>
                </div>

                <!-- Tracker Library -->
                <div class="dashboard-card full-width">
                    <div class="card-header">
                        <h2><i class="fas fa-microchip"></i> Tracker Library</h2>
                    </div>
                    <p style="color:var(--text-light);margin-bottom:1rem;">Pre-built configuration profiles for popular GPS/LTE trackers. Click a card for full setup instructions.</p>
                    <div class="tracker-toolbar">
                        <div class="tracker-filters">
                            <button class="tracker-filter-btn active" data-filter="all">All</button>
                            <button class="tracker-filter-btn" data-filter="HTTP">HTTP</button>
                            <button class="tracker-filter-btn" data-filter="TCP">TCP</button>
                            <button class="tracker-filter-btn" data-filter="MQTT">MQTT</button>
                        </div>
                        <input type="text" id="trackerSearch" class="tracker-search" placeholder="Search trackers...">
                    </div>
                    <div id="trackerLibraryGrid" class="tracker-grid"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- Tracker Configuration Modal -->
    <div id="trackerConfigModal" class="modal-overlay" style="display:none;">
        <div class="modal-content" style="max-width:720px;max-height:90vh;overflow-y:auto;">
            <div class="modal-header">
                <h3 id="tcmTitle">Tracker Configuration</h3>
                <button class="modal-close" onclick="closeTrackerConfigModal()">&times;</button>
            </div>
            <div class="modal-body" id="tcmBody"></div>
        </div>
    </div>

    <!-- Package Form Modal -->
    <div id="packageFormModal" class="modal">
        <div class="modal-content" style="max-width:600px;">
            <div class="modal-header">
                <h2 id="packageFormTitle">Add Package</h2>
                <button class="modal-close" id="closePackageModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="packageForm">
                    <div class="form-row" style="display:flex;gap:1rem;">
                        <div class="form-group" style="flex:1;">
                            <label>Package ID *</label>
                            <input type="text" id="packageId" name="packageId" required placeholder="e.g., track, monitor, predict">
                            <small>Unique identifier (lowercase, no spaces)</small>
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label>Package Name *</label>
                            <input type="text" id="packageName" name="packageName" required placeholder="e.g., Track, Monitor, Predict">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="packageDescription" name="packageDescription" placeholder="Short description of what's included">
                    </div>
                    <div class="form-row" style="display:flex;gap:1rem;">
                        <div class="form-group" style="flex:1;">
                            <label>Price per Asset/Month (&euro;) *</label>
                            <input type="number" id="packagePrice" name="packagePrice" required min="0" step="0.01" placeholder="14.95">
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label>Annual Price per Asset (&euro;)</label>
                            <input type="number" id="packageAnnualPrice" name="packageAnnualPrice" min="0" step="0.01" placeholder="179.40">
                            <small>Leave empty to calculate as price &times; 12</small>
                        </div>
                    </div>
                    <div class="form-row" style="display:flex;gap:1rem;">
                        <div class="form-group" style="flex:1;">
                            <label>Tracking Interval</label>
                            <input type="text" id="packageInterval" name="packageInterval" placeholder="e.g., 5 min, 1 min, 10 sec">
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label>Data Allowance</label>
                            <input type="text" id="packageData" name="packageData" placeholder="e.g., 50 MB, 200 MB, 500 MB">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Max Assets</label>
                        <input type="number" id="packageMaxDevices" name="packageMaxDevices" min="0" value="0" placeholder="0">
                        <small>0 = unlimited (per-asset pricing applies)</small>
                    </div>
                    <div class="form-group">
                        <label>Features <small style="font-weight:normal;color:var(--text-light);">(one per line)</small></label>
                        <textarea id="packageFeatures" rows="5" placeholder="Live GPS fleet map&#10;Basic geofence alerts&#10;Device management&#10;Mobile app access" style="width:100%;padding:0.5rem;border:1px solid var(--border-color);border-radius:0.25rem;font-family:inherit;resize:vertical;"></textarea>
                    </div>
                    <div style="display:flex;gap:1.5rem;margin-bottom:1rem;">
                        <div class="form-group checkbox-group" style="margin-bottom:0;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="packageFeatured">
                                <span>Popular / Featured</span>
                            </label>
                        </div>
                        <div class="form-group checkbox-group" style="margin-bottom:0;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="packageActive" checked>
                                <span>Active (visible to customers)</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="closePackageModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Package</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Payment Configuration Modal -->
    <div id="paymentConfigModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="paymentConfigTitle">Configure Payment Method</h2>
                <button class="modal-close" id="closePaymentModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="paymentConfigForm">
                    <div class="form-group">
                        <label id="paymentKey1Label">API Key</label>
                        <input type="text" id="paymentKey1" placeholder="Enter API key">
                    </div>
                    <div class="form-group">
                        <label id="paymentKey2Label">Secret Key</label>
                        <input type="password" id="paymentKey2" placeholder="Enter secret key">
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="useTestModePayment">
                            <span>Use Test Mode</span>
                        </label>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="closePaymentConfigModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Configuration</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Invoice Create/Edit Modal -->
    <div id="invoiceFormModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="invoiceFormTitle"><i class="fas fa-file-invoice"></i> Create Invoice</h2>
                <button class="modal-close" id="closeInvoiceFormModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="invoiceForm">
                    <input type="hidden" id="invoiceEditId" value="">

                    <div class="form-row">
                        <div class="form-group">
                            <label>Customer *</label>
                            <select id="invoiceCustomer" required>
                                <option value="">Select customer...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="invoiceStatus">
                                <option value="pending">Pending</option>
                                <option value="paid">Paid</option>
                                <option value="void">Void</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Invoice Date *</label>
                            <input type="date" id="invoiceDate" required>
                        </div>
                        <div class="form-group">
                            <label>Due Date *</label>
                            <input type="date" id="invoiceDueDate" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Payment Method</label>
                            <select id="invoicePaymentMethod">
                                <option value="N/A">N/A</option>
                                <option value="Credit Card">Credit Card</option>
                                <option value="Bank Transfer">Bank Transfer</option>
                                <option value="PayPal">PayPal</option>
                                <option value="Stripe">Stripe</option>
                                <option value="Check">Check</option>
                                <option value="Cash">Cash</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tax Rate (%)</label>
                            <input type="number" id="invoiceTaxRate" min="0" max="100" step="0.01" value="0" placeholder="0">
                        </div>
                    </div>

                    <div class="invoice-items-section">
                        <div class="invoice-items-header">
                            <h3>Line Items</h3>
                            <button type="button" class="btn btn-small btn-outline" onclick="addInvoiceLineItem()">
                                <i class="fas fa-plus"></i> Add Item
                            </button>
                        </div>
                        <table class="data-table invoice-items-table">
                            <thead>
                                <tr>
                                    <th style="width:45%">Description</th>
                                    <th style="width:15%">Qty</th>
                                    <th style="width:20%">Unit Price</th>
                                    <th style="width:15%">Total</th>
                                    <th style="width:5%"></th>
                                </tr>
                            </thead>
                            <tbody id="invoiceItemsBody">
                                <tr class="invoice-item-row">
                                    <td><input type="text" class="item-description" placeholder="Item description" required></td>
                                    <td><input type="number" class="item-quantity" min="1" value="1" onchange="recalcInvoiceItemRow(this)"></td>
                                    <td><input type="number" class="item-unit-price" min="0" step="0.01" value="0" placeholder="0.00" onchange="recalcInvoiceItemRow(this)"></td>
                                    <td class="item-total">&euro;0.00</td>
                                    <td><button type="button" class="btn-icon-small delete" onclick="removeInvoiceLineItem(this)" title="Remove"><i class="fas fa-times"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="invoice-form-totals">
                            <div class="total-line"><span>Subtotal:</span> <span id="invoiceFormSubtotal">&euro;0.00</span></div>
                            <div class="total-line"><span>Tax:</span> <span id="invoiceFormTax">&euro;0.00</span></div>
                            <div class="total-line grand"><span>Total:</span> <span id="invoiceFormTotal">&euro;0.00</span></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Notes</label>
                        <textarea id="invoiceNotes" rows="2" placeholder="Additional notes (optional)"></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="closeInvoiceFormModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="invoiceFormSubmitBtn">Create Invoice</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Invoice Detail Modal -->
    <div id="invoiceDetailModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="invoiceDetailTitle"><i class="fas fa-file-invoice"></i> Invoice Details</h2>
                <button class="modal-close" id="closeInvoiceDetailModal">&times;</button>
            </div>
            <div class="modal-body" id="invoiceDetailBody">
            </div>
        </div>
    </div>

    <!-- Send Invoice Modal -->
    <div id="sendInvoiceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-paper-plane"></i> Send Invoice</h2>
                <button class="modal-close" id="closeSendInvoiceModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="sendInvoiceForm">
                    <input type="hidden" id="sendInvoiceId" value="">
                    <div class="form-group">
                        <label>Recipient Email *</label>
                        <input type="email" id="sendInvoiceEmail" required placeholder="customer@example.com">
                    </div>
                    <div class="form-group">
                        <label>Subject</label>
                        <input type="text" id="sendInvoiceSubject" placeholder="Invoice from Aurion">
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea id="sendInvoiceMessage" rows="4" placeholder="Please find attached your invoice..."></textarea>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="sendInvoiceAttachPDF" checked>
                            <span>Attach invoice PDF</span>
                        </label>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="closeSendInvoiceModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Send Invoice</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="storage-sync.js?v=20260219c"></script>
    <script src="auth.js?v=20260219c"></script>
    <script src="admin-auth.js?v=20260219c"></script>
    <script src="data-protection.js?v=20260219c"></script>
    <script src="invoice.js?v=20260219c"></script>
    <script src="admin.js?v=20260219c"></script>
    <link rel="stylesheet" href="support-bot.css">
    <script src="support-bot.js"></script>
</body>
</html>

